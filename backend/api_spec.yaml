openapi: "3.0.2"
info:
  title: "waterprobing"
  description: "API for waterprobing"
  version: "1"
  termsOfService: "https://openweathermap.org/terms"
  contact:
    name: "OpenWeatherMap API"
    email: "sw708e19@gmail.com"
  license:
    name: "CC Attribution-ShareAlike 4.0 (CC BY-SA 4.0)"
    url: "https://openweathermap.org/price"

servers:
#These should be changed once we have servers, consider having production and ...
  - url: https://api.openweathermap.org/data/2.5/
    description: Production server
  - url: http://beta.api.openweathermap.org/data/2.5/
    description: Beta server
  - url: http://some-other.api.openweathermap.org/data/2.5/
    description: Some other server

paths:
  /Thing:
    get:
      tags: 
      - Thing
      summary: "Get an existing probe"
      description: "desc"
      operationId: getThing
      parameters:
       - $ref: '#/components/parameters/thingname'
      responses:
        200:
          $ref: '#/components/responses/200'
        404:
          $ref: '#/components/responses/404'
    post:
      tags:
       - Thing
      summary: "Creates a new probe"
      description: "Creates new thing"
      operationId: "NewThing"
      responses:
        201:
          $ref: '#/components/responses/201'
        404:
          $ref: '#/components/responses/404'
        
      #deprecated:
      #security:
      #servers:
      requestBody:
        description: Optional properties represented as json for the Thing
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/thing'
              
    delete:
      tags: 
      - Thing
      summary: "Delete an existing probe"
      description: "desc"
      operationId: deleteThing
      parameters:
       - $ref: '#/components/parameters/thingname'
        
      responses:
        200:
          $ref: '#/components/responses/200'
        404:
          $ref: '#/components/responses/404'
  
  /Observation:
    get:
      tags:
      - Observation
      summary: "Call to write observation to database"
      operationId: getObservation
      responses:
        201:
          $ref: '#/components/responses/201'
        404:
          $ref: '#/components/responses/404'
      
      parameters: 
       - $ref: '#/components/parameters/observation'
    post:
      tags:
      - Observation
      summary: "Call to write observation to database"
      operationId: postObservation
      responses:
        201:
          $ref: '#/components/responses/201'
        404:
          $ref: '#/components/responses/404'
      
      requestBody:
        description: Optional properties represented as json for the Thing
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/observation'
              

              
              
  /dataStream:
    get:
      tags: 
      - Datastream
      summary: "Gets a datastream"
      operationId: getDatastream
      responses:
        200:
          $ref: '#/components/responses/200'
        404:
          $ref: '#/components/responses/404'
                
      parameters: 
        - $ref: '#/components/parameters/dataStream'
        
    put:
      tags: 
      - Datastream
      summary: "put to a datastream"
      operationId: putDatastream
      responses:
        201:
          $ref: '#/components/responses/201'
        404:
          $ref: '#/components/responses/404'
                
      parameters: 
        - $ref: '#/components/parameters/dataStream'
        
      requestBody:
        description: Optional properties represented as json for the dataStream
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/dataStream'
    
    post:
      tags: 
      - Datastream
      summary: "posts a datastream"
      operationId: postDatastream
      responses:
        201:
          $ref: '#/components/responses/201'
        404:
          $ref: '#/components/responses/404'
                
      requestBody:
        description: Optional properties represented as json for the dataStream
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/dataStream'
    
    delete:
      tags: 
      - Datastream
      summary: "deletes a datastream"
      operationId: deleteDatastream
      responses:
        200:
          $ref: '#/components/responses/200'
        404:
          $ref: '#/components/responses/404'
                
      parameters: 
        - $ref: '#/components/parameters/dataStream'
    
    
  /sensor:
    get:
      tags: 
      - Sensor
      summary: "gets a sensor"
      operationId: getSensor
      responses:
        200:
          $ref: '#/components/responses/200'
        404:
         $ref: '#/components/responses/404'
                
      parameters: 
        - $ref: '#/components/parameters/sensor'
        
    
    put:
      tags: 
      - Sensor
      summary: "puts a sensor"
      operationId: putSensor
      responses:
        200:
          $ref: '#/components/responses/200'
        404:
          $ref: '#/components/responses/404'
                
      parameters: 
        - $ref: '#/components/parameters/sensor'
      
      requestBody:
        description: Optional properties represented as json for the dataStream
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/sensor'
        
    post:
      tags: 
      - Sensor
      summary: "post a sensor"
      operationId: postSensor
      responses:
        200:
          $ref: '#/components/responses/200'
        404:
          $ref: '#/components/responses/404'
                
      requestBody:
        description: Optional properties represented as json for the dataStream
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/sensor'
        
    
    delete:
      tags: 
      - Sensor
      summary: "deletes a sensor"
      operationId: deleteSensor
      responses:
        200:
          $ref: '#/components/responses/200'
        404:
          $ref: '#/components/responses/404'
                
      parameters: 
        - $ref: '#/components/parameters/sensor'
    
      
  /Location:
    get:
      tags:
       - location
      summary: "gets a location"
      operationId: getLocation
      responses:
        200:
          $ref: '#/components/responses/200'
        404:
          $ref: '#/components/responses/404'
                
    parameters:
      - $ref: '#/components/parameters/location'
    
    post:
      tags:
       - location
      summary: "posting a new location"
      operationId: postlocation
      responses:
        201:
          $ref: '#/components/responses/201'
        404:
          $ref: '#/components/responses/404'

components:
  responses:
    200:
      description: Successful response
      content:
        application/json:
          schema:
            title: Sample
            type: object
            properties:
              placeholder:
                type: string
                description: Placeholder description
    201:
      description: Successful response
      content:
        application/json:
          schema:
            title: Sample
            type: object
            properties:
              placeholder:
                type: string
                description: Placeholder description
    
    404:
      description: Not created response
      content:
        text/plain:
          schema:
            title: Thing not cretead
            type: string
            example:
    
  parameters:
    observation: 
      name: observationName
      in: query
      description: "Unique observationName"
      required: false
      schema:
        type: string
      
    dataStream: 
      name: dataStreamName
      in: query
      description: "Unique dataStreamName"
      schema:
        type: string
        
    sensor: 
      name: sensorName
      in: query
      description: "Unique sensorName"
      schema:
        type: string
        
    thingname: 
      name: thingname
      in: query
      description: "Unique thingName"
      schema:
        type: string
        
    location:
      name: locationName
      in: query
      description: "Unique locationName"
      schema:
        type: string
    

  schemas:
    tmObject:
      type: object
      properties:
        time:
          type: string 
          
    
    dqElement:
      type: object
      
    
    tmInstant:
      type: object
      properties:
        time:
          type: string
          
    tmPeriod:
      type: object
      
    
    namedValue:
      type: object
      
    valueCode:
      type: object
      
  
    gm_envelope:
      type: object
  
    thing:
      type: object
      required:
        - name
        - description
        
      properties:
        name:
          type: string
        description: 
          type: string
        properties:
          type: array
          items:
            type: object
          
          
    observation:
      type: object
      required:
        - phenomenonTime 
        - resultTime
        - result
        
      properties:
        phenomenonTime:
          $ref: '#/components/schemas/tmObject'
        resultTime:
          $ref: '#/components/schemas/tmInstant'
        result:
          type: number
        resultQuality:
          type: array
          items: 
            $ref: '#/components/schemas/dqElement'
        validTime:
          type: array
          items:
            $ref: '#/components/schemas/tmPeriod'
        parameters:
          type: array
          items:
            $ref: '#/components/schemas/namedValue'
            
      
    dataStream:
      type: object
      required:
       - name
       - description
       - observationType
       - unitOfMeasurement
       
      properties:
        name:
          type: string
        description:
          type: string
        observationType:
          $ref: '#/components/schemas/valueCode'
        observedArea:
          $ref: '#/components/schemas/gm_envelope'
        phenomenonTime:
          $ref: '#/components/schemas/tmPeriod'
        resultTime:
          $ref: '#/components/schemas/tmPeriod'
          
    
    sensor:
      type: object
      required:
       - name
       - description
       - encodingType
       - metaData
      
      properties:
        name:
          type: string
        description:
          type: string
        encodingType:
          $ref: '#/components/schemas/valueCode'
        metaData:
          type: object         
